import axios from "axios";
export const registerUser=(registerdetails)=> async (dispatch)=>{

    try {
        dispatch({type: "REGISTER_USER_REQUEST"});
        const response= await axios.post(`${process.env.REACT_APP_BACKEND}/api/users/registration`, registerdetails);
        //console.log(response.data);
        dispatch({type: "REGISTER_USER_SUCCESS"});
        return Promise.resolve(response.data);
    } catch (error) {
        //console.log("from inside actions page error",error);
        dispatch({type: "REGISTER_USER_FAILED", payload: error});
        return Promise.reject(error);
    }
}

export const userLogin=(logindetails)=> async (dispatch)=>{

    try {
        dispatch({type: "LOGIN_USER_REQUEST"});
        const response= await axios.post(`${process.env.REACT_APP_BACKEND}/api/users/login`, logindetails);
        //console.log(response.data);
        dispatch({type: "LOGIN_USER_SUCCESS"});
        localStorage.setItem('activeUser', JSON.stringify(response.data));
        return Promise.resolve(response.data);
    } catch (error) {
        dispatch({type: "LOGIN_USER_FAILED", payload: error});
        return Promise.reject(error);
    }
}


export const userLogout=()=>(dispatch)=>{

    try {
        localStorage.removeItem('booksInCart');
        localStorage.removeItem('activeUser');
        dispatch({type: 'LOGOUT_USER'});
        window.location.href="/login"
    } catch (error) {
        dispatch({type: "LOGOUT_FAILED"});
        console.log(error);
    }
}