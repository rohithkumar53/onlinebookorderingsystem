import axios from 'axios';
export const orderPayment= (token, amttopay)=>async (dipatch, getState)=>{
    try {
        //get currently logged in user details
        const activeUser= getState().userLoginReducer.activeUser;
        //get all books in cart
        const bookInCart= getState().addToCartReducer.book;
        //creating a new array book item so that we can add the field that are necessary.
        const book= new Array();
        for(let eachbook of bookInCart){
            let bookitem={
                name: eachbook.name,
                copies: eachbook.copies,
                price: eachbook.price,
                _id: eachbook._id
            }
            book.push(bookitem);
        }

        const order={token, amttopay, activeUser, book};

        dipatch({type: "ORDER_PLACE_REQUEST"});
        const response= await axios.post(`${process.env.REACT_APP_BACKEND}/api/orders/orderplace`, order);
        dipatch({type: "ORDER_PLACE_SUCCESS"});
    } catch (error) {
        console.log(error);
        dipatch({type: "ORDER_PLACE_FAILED"});
    }

}